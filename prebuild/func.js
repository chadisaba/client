var func=func||{};func.Report={createNewReport:function(e,t,r,o,a){var n=new Promise(function(n,s){var d=new Date,i=d.getFullYear(),c=d.getMonth(),l={};l.reportId=UUID(),l.doctorId=e,l.visitId=t,l.reportName=l.reportId+".docx",l.reportPath="site"+r+"/"+i+"/"+c,l.reportDate=new Date,l.reportStatus=1;var p=CommonDirect.saveData(l,"REPORT",""),u={};u.worklistId=o,u.patientId=a,u.siteId=r,u.visitId=t,u.worklistLastCrStatus=1;var w=l.reportPath+"/"+l.reportName,m=CommonDirect.saveData(u,"WORKLIST","");Promise.all([p,m]).then(function(e){var t;t=new XMLHttpRequest,t.onreadystatechange=function(){4==t.readyState&&200==t.status&&("success"==t.responseText?(t.open("POST","http://localhost:1000/openWord",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("jsDavUrl="+o+"&wordPath="+r+"&docPath="+w),Ext.GlobalEvents.fireEvent("refreshWorklistEvent"),n("success")):s("reportFileCreationisFailed"))};var r=window.localStorage.getItem("smartmed-wordPath"),o=window.localStorage.getItem("smartmed-jsDavUrl");t.open("POST","http://localhost:7000/createWord",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("docPath="+w)})});return n}};