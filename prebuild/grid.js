var GridAddPlugins={addPlugins:function(t){t.plugins=[{ptype:"rowediting",pluginId:"rowEdit",autoCancel:!1,clicksToMoveEditor:0,errorSummary:!1}],Plugins.grid.GridEditingPlugin.configure(t),t.initialConfig.externalEditingPlugin?t.plugins.push(new Plugins.grid.GridEditingPlugin(t.initialConfig.externalEditingPlugin)):t.plugins.push(new Plugins.grid.GridEditingPlugin({pluginId:"gridediting"}))},addSearchPlugin:function(t){t.plugins=[{ptype:"cellediting",pluginId:"cellEditing"}],t.plugins.push(new Plugins.grid.GridSearchPlugin({pluginId:"gridsearch"}))}};Ext.define("Plugins.grid.GridEditingPlugin",{extend:"Ext.AbstractPlugin",alias:"widget.plugin.gridediting",statics:{configure:function(t){t.columns.push({xtype:"gridcolumn",renderer:function(t,e,n,i,d,o,l){if(void 0!==l&&null!==l){var a=l.up("gridpanel");return n.data.notValid&&!n.data.toDelete&&a.inEdition===!0?'<div class="fa fa-exclamation-triangle" style="height:16px !important;" data-qtip="${gridEdit.notValid}<br>'+n.data.notValidTip+'">&nbsp;</div>':n.data.toDelete&&a.inEdition===!0?'<div class="fa fa-trash-o" style="height:16px !important;" data-qtip="A supprimer">&nbsp;</div>':n.data.added&&a.inEdition===!0?'<div class="fa fa-plus" style="height:16px !important;" data-qtip="Ajouté">&nbsp;</div>':n.data.modified&&a.inEdition===!0?'<div class="fa fa-edit" style="height:16px !important;" data-qtip="Modifié">&nbsp;</div>':n.data.locked?'<div class="fa fa-lock" style="height:16px !important;" data-qtip="'+n.data.userID+" "+n.data.userName+'">&nbsp;</div>':""}return""},itemId:"actionColumn",maxWidth:28,minWidth:28,width:28,menuDisabled:!0,draggable:!1,enableColumnHide:!1,hideable:!1})}},config:{toolbarSelector:null},withValidation:!1,showConfirmationOnSave:!0,liveSearch:!0,preferences:!0,noModif:!1,onlyADM:!1,onlyModify:!1,onlyDelete:!1,onlyAD:!1,onlyECSQ:!1,inEditing:!1,enableDuplicate:!0,pluginId:"gridediting",init:function(t){var e=this;this.grid=t,t.inEdition=!1,this.inEditing&&(t.inEdition=!0),this.onlyADM&&(t.inEdition=!0);var n=t.query("#editingtoolbar");1==n.length?(this.tb=n[0],this.fillToolbar()):0==n.length&&(this.tb=this.createNewToolbar(),this.fillToolbar(),t.addDocked(this.tb)),t.on("select",e.gridOnSelect,e),t.on("columnmove",e.gridOnColumnMove,e),e.onlyECSQ===!1||Ext.isEmpty(t.down("#actionColumn"))||t.down("#actionColumn").hide()},getDataToBeSaved:function(){var t=this,e=[],n=["added","modified","toDelete"],i=[];return Ext.Array.each(n,function(n){Ext.each(t.grid.store.query(n,!0).items,function(n){if(n.validate().isValid())e.push(n.data);else{var d=t.grid.store.indexOf(n);d++,i.push(d)}})}),{dataToBeSaved:e,errors:i}},gridOnSelect:function(t,e,n,i){var d=this;d.onlyECSQ||d.onlyModify||d.onlyDelete||d.onlyAD||d.noModif?d.onlyModify?e.get("locked")?d.modifyBtnCtn.down("#modifyBtn").setDisabled(!0):d.modifyBtnCtn.down("#modifyBtn").setDisabled(!1):(d.onlyDelete||d.onlyAD||d.noModif)&&(e.get("locked")||e.get("toDelete")?d.deleteBtnCtn.down("#deleteBtn").setDisabled(!0):d.deleteBtnCtn.down("#deleteBtn").setDisabled(!1)):e.get("locked")||e.get("toDelete")?(d.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),d.modifyBtnCtn.down("#modifyBtn").setDisabled(!0),d.duplicateBtnCtn.down("#duplicateBtn").setDisabled(!0)):(d.deleteBtnCtn.down("#deleteBtn").setDisabled(!1),d.modifyBtnCtn.down("#modifyBtn").setDisabled(!1),d.duplicateBtnCtn.down("#duplicateBtn").setDisabled(!1))},gridOnColumnMove:function(t,e,n,i,d){var o=this;if(t.enableColumnMove=!0,o.grid.inEdition===!0)return!1},lockGrid:function(t){this.restoreGrid(),t&&this.editBtnCtn.hide()},restoreGrid:function(){var t=this;t.editBtnCtn.hide(),t.deleteBtnCtn.hide(),t.addBtnCtn.hide(),t.modifyBtnCtn.hide(),t.duplicateBtnCtn.hide(),t.saveBtnCtn.hide(),t.cancelBtnCtn.hide(),t.quitBtnCtn.hide(),t.chHistBtnCtn.hide(),t.editBtnCtn.down("#editBtn").setDisabled(!1),t.deleteBtnCtn.down("#deleteBtn").setDisabled(!1),t.addBtnCtn.down("#addBtn").setDisabled(!1),t.modifyBtnCtn.down("#modifyBtn").setDisabled(!1),t.duplicateBtnCtn.down("#duplicateBtn").setDisabled(!0),t.saveBtnCtn.down("#saveBtn").setDisabled(!1),t.cancelBtnCtn.down("#cancelBtn").setDisabled(!1),t.quitBtnCtn.down("#quitBtn").setDisabled(!1),t.chHistBtnCtn.down("#chHistBtn").setDisabled(!1),t.onlyADM||t.onlyECSQ||t.onlyModify||t.onlyDelete||t.onlyAD||t.noModif?t.onlyECSQ?(t.editBtnCtn.show(),t.chHistBtnCtn.show(),t.saveBtnCtn.down("#saveBtn").setDisabled(!0),t.cancelBtnCtn.down("#cancelBtn").setDisabled(!0)):t.onlyADM?(t.deleteBtnCtn.show(),t.addBtnCtn.show(),t.modifyBtnCtn.show(),t.chHistBtnCtn.show(),t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0)):t.onlyModify?(t.editBtnCtn.show(),t.chHistBtnCtn.show(),t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0),t.saveBtnCtn.down("#saveBtn").setDisabled(!0),t.cancelBtnCtn.down("#cancelBtn").setDisabled(!0)):t.onlyDelete?(t.editBtnCtn.show(),t.chHistBtnCtn.show(),t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),t.saveBtnCtn.down("#saveBtn").setDisabled(!0),t.cancelBtnCtn.down("#cancelBtn").setDisabled(!0)):t.onlyAD?(t.deleteBtnCtn.show(),t.addBtnCtn.show(),t.chHistBtnCtn.show(),t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0)):t.noModif&&(t.editBtnCtn.show(),t.chHistBtnCtn.show(),t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),t.saveBtnCtn.down("#saveBtn").setDisabled(!0),t.cancelBtnCtn.down("#cancelBtn").setDisabled(!0)):(t.editBtnCtn.show(),t.chHistBtnCtn.show(),t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0),t.saveBtnCtn.down("#saveBtn").setDisabled(!0),t.cancelBtnCtn.down("#cancelBtn").setDisabled(!0)),t.filterCheckBoxCtn&&t.filterCheckBoxCtn.hide(),t.enableDuplicate&&t.duplicateBtnCtn.down("#duplicateBtn").setDisabled(!1),t.chHistBtnCtn.hide()},createNewToolbar:function(){var t=Ext.create("Ext.toolbar.Toolbar",{dock:"top",itemId:"editingtoolbar"});return t},fillToolbar:function(){this.createFilterCheckboxCtn(),this.liveSearch&&(this.createLiveSearchCtn(),this.tb.add(this.liveSearchCtn)),this.createEditBtnCtn(),this.createCancelBtnCtn(),this.createSaveBtnCtn(),this.createChHistBtnCtn(),this.createAddBtnCtn(),this.createDeleteBtnCtn(),this.createModifyBtnCtn(),this.createDuplicateBtnCtn(),this.createQuitBtnCtn(),this.tb.add(this.editBtnCtn),this.tb.add(this.addBtnCtn),this.tb.add(this.deleteBtnCtn),this.tb.add(this.modifyBtnCtn),this.tb.add(this.duplicateBtnCtn),this.tb.add({xtype:"tbfill"}),this.tb.add(this.filterCheckBoxCtn),this.tb.add(this.saveBtnCtn),this.tb.add(this.cancelBtnCtn),this.tb.add(this.quitBtnCtn),this.tb.add(this.chHistBtnCtn),this.preferences&&(this.createPreferenceBtnCtn(),this.tb.add(this.preferenceBtnCtn))},createFilterCheckboxCtn:function(){var t=this;this.filterCheckBoxCtn=Ext.create("Ext.container.Container",{itemId:"CheckBoxCtn",hidden:!0,items:[{xtype:"checkbox",fieldBodyCls:"x-form-cb-wrap-default_toolbar",boxLabel:translate("displayModifiedRows"),itemId:"filterCheckbox",listeners:{change:function(e){t.liveSearchCtn.setValue("");var n,i=t.grid.getStore();i.clearFilter(),e.getValue()&&i.filterBy(function(t){return n=!1,(t.get("added")||t.get("modified")||t.get("toDelete"))&&(n=!0),n})}}}]})},createLiveSearchCtn:function(){var t=this;t.liveSearchCtn=Ext.create("Ext.form.TextField",{fieldStyle:"font-family: FontAwesome",emptyText:translate("liveSearch"),listeners:{specialkey:function(e,n){var i=e.getValue();if(n.getKey()===n.ENTER){var d=t.grid.getStore();d.clearFilter(),Ext.isEmpty(i)||d.filterBy(function(t){var e=!1,n=t.getData();for(var d in n)n[d]&&n[d].toString().indexOf(i.toString())>=0&&(e=!0);return e})}}},triggers:{mytrigger2:{handler:function(e,n,i){e.setValue(""),t.grid.getStore().clearFilter()},cls:"x-form-clear-trigger"}}})},createEditBtnCtn:function(){var t=this;this.editBtnCtn=Ext.create("Ext.container.Container",{itemId:"editBtnCtn",hidden:!0,items:[{xtype:"button",text:translate("edit"),tooltip:translate("clickToSwitchInEditMode"),itemId:"editBtn",glyph:"xf040@FontAwesome",listeners:{click:function(e,n,i){t.enterEditMode(),t.grid.fireEvent("inEdit",t.grid)}}}]})},createCancelBtnCtn:function(){var t=this;this.cancelBtnCtn=Ext.create("Ext.container.Container",{itemId:"cancelBtnCtn",hidden:!0,items:[{xtype:"button",itemId:"cancelBtn",glyph:"xf0e2@FontAwesome",disabled:!0,tooltip:translate("clickToCancelModifications"),listeners:{click:function(e,n,i){var d=Ext.create("Common.ux.window.PromptWindow",{withClose:!1});d.setTitle(translate("cancelTitle")),d.down("#confirmMsg").setText(translate("cancelMsg")),d.down("#description").hide(),d.down("#inputText").hide(),d.query("button")[0].setText(translate("yes")),d.query("button")[1].setText(translate("no")),d.callbackFunction=function(e,n){"ok"===e?(Utility.loading.start(d.query("button")[0]),t.cancelEdit(),t.grid.fireEvent("resetEdit",t.grid,d)):d.close()},d.show()}}}]})},createSaveBtnCtn:function(){var t=this;this.saveBtnCtn=Ext.create("Ext.container.Container",{itemId:"saveBtnCtn",hidden:!0,items:[{xtype:"button",itemId:"saveBtn",disabled:!0,glyph:"xf0c7@FontAwesome",tooltip:translate("clickToSaveModifications"),listeners:{click:function(e,n,i){if(t.showConfirmationOnSave){var d=t.getDataToBeSaved(),o=d.dataToBeSaved,l=d.errors;if(l.length>0)Ext.MessageBox.show({title:"Erreur",msg:l,icon:Ext.MessageBox.WARNING,buttons:Ext.MessageBox.OK});else{var a=Ext.create("Common.ux.window.PromptWindow",{withClose:!1,closable:!1});t.withValidation?(a.setTitle(translate("msg.comment")),a.down("#confirmMsg").setText(translate("submitMsg"))):(a.setTitle(translate("applyChTitle")),a.down("#confirmMsg").setText(translate("ApplyModification?"))),a.query("button")[0].setText(translate("yes")),a.query("button")[1].setText(translate("no")),a.down("#description").setText(translate("comment")),a.callbackFunction=function(e,n){"ok"===e?(Utility.loading.start(a.query("button")[0]),t.grid.fireEvent("saveEdit",t.grid,a,o,n)):a.close()},a.show()}}else t.grid.fireEvent("saveEdit",t.grid)}}}]})},createChHistBtnCtn:function(){var t=this;this.chHistBtnCtn=Ext.create("Ext.container.Container",{itemId:"chHistBtnCtn",items:[{xtype:"button",itemId:"chHistBtn",glyph:"xf073@FontAwesome",tooltip:translate("modificationsHistory"),listeners:{click:function(e,n,i){t.grid.fireEvent("chHist",t.grid)}}}]})},createAddBtnCtn:function(){var t=this;this.addBtnCtn=Ext.create("Ext.container.Container",{itemId:"addBtnCtn",hidden:!0,items:[{xtype:"button",itemId:"addBtn",glyph:"xf067@FontAwesome",tooltip:translate("clickToAddNewRow"),listeners:{click:function(e,n,i){t.grid.fireEvent("addItem",t.grid)}}}]})},createDuplicateBtnCtn:function(){var t=this;this.duplicateBtnCtn=Ext.create("Ext.container.Container",{itemId:"duplicateBtnCtn",hidden:!0,items:[{xtype:"button",itemId:"duplicateBtn",glyph:"xf0c5@FontAwesome",tooltip:translate("clickToDuplicateRow"),listeners:{click:function(e,n,i){t.grid.fireEvent("duplicateItem",t.grid)}}}]})},createDeleteBtnCtn:function(){var t=this;this.deleteBtnCtn=Ext.create("Ext.container.Container",{itemId:"deleteBtnCtn",hidden:!0,items:[{xtype:"button",itemId:"deleteBtn",glyph:"xf014@FontAwesome",disabled:!0,tooltip:translate("clickToDeleteTheSelection"),listeners:{click:function(e,n,i){t.onlyDelete===!1&&t.onlyAD===!1&&t.noModif===!1&&t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0),t.duplicateBtnCtn.down("#duplicateBtn").setDisabled(!0),t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),t.grid.fireEvent("deleteItem",t.grid)}}}]})},createModifyBtnCtn:function(){var t=this;this.modifyBtnCtn=Ext.create("Ext.container.Container",{itemId:"modifyBtnCtn",hidden:!0,items:[{xtype:"button",itemId:"modifyBtn",disabled:!0,glyph:"xf044@FontAwesome",tooltip:translate("clickToModifySelection"),listeners:{click:function(e,n,i){t.grid.fireEvent("modifyItem",t.grid)}}}]})},createPreferenceBtnCtn:function(){this.preferenceBtnCtn=Ext.create("Ext.container.Container",{itemId:"preferenceBtnCtn",items:[{xtype:"button",itemId:"preferenceBtn",glyph:"xf234@FontAwesome",tooltip:translate("clickToSavePreference"),listeners:{click:function(t,e,n){StateProvider.saveState(window.localStorage.getItem("smartmed-userId"))}}}]})},createQuitBtnCtn:function(){var t=this;this.quitBtnCtn=Ext.create("Ext.container.Container",{itemId:"quitBtnCtn",hidden:!0,items:[{xtype:"button",itemId:"quitBtn",glyph:"xf08b@FontAwesome",tooltip:translate("quit"),listeners:{click:function(e,n,i){var d=Ext.create("Common.ux.window.PromptWindow",{withClose:!1});d.setTitle(translate("gridEdit.quitEditionTitle")),d.down("#confirmMsg").setText(translate("gridEdit.quitEditionMsg")),d.down("#description").hide(),d.down("#inputText").hide(),d.query("button")[0].setText(translate("yes")),d.query("button")[1].setText(translate("no")),d.callbackFunction=function(e,n){"ok"===e?(Utility.loading.start(d.query("button")[0]),t.grid.fireEvent("quitEdit",t.grid,d)):d.close()},d.show()}}}]})},enterEditMode:function(){var t=this;if(t.grid.inEdition=!0,t.editBtnCtn.hide(),t.cancelBtnCtn.show(),t.saveBtnCtn.show(),t.quitBtnCtn.show(),t.filterCheckBoxCtn.show(),t.duplicateBtnCtn.show(),t.saveBtnCtn.down("#saveBtn").setDisabled(!0),t.cancelBtnCtn.down("#cancelBtn").setDisabled(!0),t.grid.getSelectionModel().hasSelection())var e=t.grid.getSelectionModel().getSelection()[0];this.onlyECSQ||this.onlyModify||this.onlyDelete||this.onlyAD||this.noModif?this.onlyModify===!0?(t.modifyBtnCtn.show(),t.grid.getSelectionModel().hasSelection()&&(e.get("locked")?t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0):e.get("locked")||t.modifyBtnCtn.down("#modifyBtn").setDisabled(!1))):this.onlyDelete===!0||this.onlyAD===!0?(t.deleteBtnCtn.show(),t.grid.getSelectionModel().hasSelection()&&(e.get("locked")||e.get("toDelete")?t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0):e.get("locked")||e.get("toDelete")||t.deleteBtnCtn.down("#deleteBtn").setDisabled(!1))):this.noModif===!0&&(t.deleteBtnCtn.show(),t.addBtnCtn.show(),t.grid.getSelectionModel().hasSelection()&&(t.grid.getSelectionModel().getSelection()[0].data.locked||t.grid.getSelectionModel().getSelection()[0].data.toDelete)?t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0):!t.grid.getSelectionModel().hasSelection()||t.grid.getSelectionModel().getSelection()[0].data.locked||t.grid.getSelectionModel().getSelection()[0].data.toDelete||t.deleteBtnCtn.down("#deleteBtn").setDisabled(!1)):(t.deleteBtnCtn.show(),t.addBtnCtn.show(),t.modifyBtnCtn.show(),t.grid.getSelectionModel().hasSelection()&&(e.get("locked")||e.get("toDelete")?(t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0),t.duplicateBtnCtn.down("#duplicateBtn").setDisabled(!0)):e.get("locked")||e.get("locked")||(t.deleteBtnCtn.down("#deleteBtn").setDisabled(!1),t.modifyBtnCtn.down("#modifyBtn").setDisabled(!1),t.duplicateBtnCtn.down("#duplicateBtn").setDisabled(!1))))},quitEditMode:function(){var t=this;t.grid.inEdition=!1,t.restoreGrid()},cancelEdit:function(){var t=this;if(t.cancelBtnCtn.down("#cancelBtn").setDisabled(!0),t.saveBtnCtn.down("#saveBtn").setDisabled(!0),t.grid.getSelectionModel().hasSelection())var e=t.grid.getSelectionModel().getSelection()[0];this.onlyECSQ||this.onlyModify||this.onlyDelete||this.onlyAD||this.noModif?this.onlyModify?(t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0),e.get("locked")?t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0):e.get("locked")||t.modifyBtnCtn.down("#modifyBtn").setDisabled(!1)):this.onlyDelete||this.onlyAD?(t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),e.get("locked")||e.get("toDelete")?t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0):e.get("locked")||e.get("toDelete")||t.deleteBtnCtn.down("#deleteBtn").setDisabled(!1)):this.noModif===!0&&(t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),e.get("locked")||e.get("toDelete")?t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0):e.get("locked")||e.get("toDelete")||t.deleteBtnCtn.down("#deleteBtn").setDisabled(!1),t.addBtnCtn.down("#addBtn").setDisabled(!1)):(t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0),t.grid.getSelectionModel().hasSelection()&&(e.get("locked")||e.get("toDelete")?(t.deleteBtnCtn.down("#deleteBtn").setDisabled(!0),t.modifyBtnCtn.down("#modifyBtn").setDisabled(!0),t.duplicateBtnCtn.down("#duplicateBtn").setDisabled(!0)):e.get("locked")||e.get("toDelete")||(t.deleteBtnCtn.down("#deleteBtn").setDisabled(!1),t.modifyBtnCtn.down("#modifyBtn").setDisabled(!1),t.duplicateBtnCtn.down("#duplicateBtn").setDisabled(!1))),t.addBtnCtn.down("#addBtn").setDisabled(!1)),t.editBtnCtn.hide()},checkIfModifications:function(){var t=this,e=t.grid;0==e.getStore().query("notValid",!0).items.length?e.getStore().query("toDelete",!0).items.length>0||e.getStore().query("added",!0).items.length>0||e.getStore().query("modified",!0).items.length>0?(t.saveBtnCtn&&t.saveBtnCtn.down("#saveBtn").setDisabled(!1),t.cancelBtnCtn&&t.cancelBtnCtn.down("#cancelBtn").setDisabled(!1)):(t.saveBtnCtn&&t.saveBtnCtn.down("#saveBtn").setDisabled(!0),t.cancelBtnCtn&&t.cancelBtnCtn.down("#cancelBtn").setDisabled(!0)):(t.saveBtnCtn&&t.saveBtnCtn.down("#saveBtn").setDisabled(!0),t.cancelBtnCtn&&t.cancelBtnCtn.down("#cancelBtn").setDisabled(!1))},fillInInterfaceOn:function(){var t=this,e=t.grid;e.down("#duplicateBtn").setDisabled(!0),t.onlyADM||t.onlyECSQ||t.onlyModify||t.onlyDelete||t.onlyAD||t.noModif?t.onlyADM?(e.down("#modifyBtn").setDisabled(!0),e.down("#addBtn").setDisabled(!0),e.down("#deleteBtn").setDisabled(!0),e.down("#chHistBtn").setDisabled(!0)):t.onlyECSQ?(e.down("#saveBtn").setDisabled(!0),e.down("#cancelBtn").setDisabled(!0),e.down("#quitBtn").setDisabled(!0),e.down("#chHistBtn").setDisabled(!0)):t.onlyModify?(e.down("#modifyBtn").setDisabled(!0),e.down("#saveBtn").setDisabled(!0),e.down("#cancelBtn").setDisabled(!0),e.down("#quitBtn").setDisabled(!0),e.down("#chHistBtn").setDisabled(!0)):t.onlyDelete?(e.down("#saveBtn").setDisabled(!0),e.down("#cancelBtn").setDisabled(!0),e.down("#deleteBtn").setDisabled(!0),e.down("#quitBtn").setDisabled(!0),e.down("#chHistBtn").setDisabled(!0)):t.onlyAD?(e.down("#addBtn").setDisabled(!0),e.down("#deleteBtn").setDisabled(!0),e.down("#chHistBtn").setDisabled(!0)):t.noModif&&(e.down("#saveBtn").setDisabled(!0),e.down("#cancelBtn").setDisabled(!0),e.down("#addBtn").setDisabled(!0),e.down("#deleteBtn").setDisabled(!0),e.down("#quitBtn").setDisabled(!0),e.down("#chHistBtn").setDisabled(!0)):(e.down("#modifyBtn").setDisabled(!0),e.down("#saveBtn").setDisabled(!0),e.down("#cancelBtn").setDisabled(!0),e.down("#addBtn").setDisabled(!0),e.down("#deleteBtn").setDisabled(!0),e.down("#quitBtn").setDisabled(!0),e.down("#chHistBtn").setDisabled(!0))},fillInInterfaceOff:function(){var t=this,e=t.grid,n=e.getSelectionModel().hasSelection(),i=e.getSelectionModel().getSelection()[0];e.down("#chHistBtn").setDisabled(!1),t.onlyADM||t.onlyAD||(e.down("#quitBtn").setDisabled(!1),t.onlyECSQ||t.checkIfModifications()),t.onlyECSQ||t.onlyModify||t.onlyDelete||t.onlyAD||t.noModif?t.onlyModify?n&&i.data.locked?e.down("#modifyBtn").setDisabled(!0):e.down("#modifyBtn").setDisabled(!1):t.onlyDelete?n&&i.data.locked?e.down("#deleteBtn").setDisabled(!0):e.down("#deleteBtn").setDisabled(!1):t.onlyAD?(n&&i.data.locked?e.down("#deleteBtn").setDisabled(!0):e.down("#deleteBtn").setDisabled(!1),e.down("#addBtn").setDisabled(!1)):t.noModif&&(n&&i.data.locked?e.down("#deleteBtn").setDisabled(!0):e.down("#deleteBtn").setDisabled(!1),e.down("#addBtn").setDisabled(!1)):(n&&i.data.locked?(e.down("#deleteBtn").setDisabled(!0),e.down("#modifyBtn").setDisabled(!0),e.down("#duplicateBtn").setDisabled(!0)):(e.down("#deleteBtn").setDisabled(!1),e.down("#modifyBtn").setDisabled(!1),e.down("#duplicateBtn").setDisabled(!1)),e.down("#addBtn").setDisabled(!1))}}),Ext.define("Plugins.grid.GridInfoColumnPlugin",{extend:"Ext.AbstractPlugin",alias:"widget.plugin.infocolumn",statics:{configure:function(t){t.columns.push({xtype:"gridcolumn",renderer:function(t,e,n,i,d,o,l){return void 0!==l&&null!==l?n.get("added")?'<div class="fa fa-plus" style="height:16px !important;" data-qtip="Ajouté">&nbsp;</div>':n.get("modified")?'<div class="fa fa-edit" style="height:16px !important;" data-qtip="Modifié">&nbsp;</div>':n.get("deleted")?'<div class="fa fa-trash-o" style="height:16px !important;" data-qtip="A supprimer">&nbsp;</div>':"":""},itemId:"actionColumn",maxWidth:28,minWidth:28,width:28,menuDisabled:!0,draggable:!1,enableColumnHide:!1,hideable:!1})}},config:{toolbarSelector:null},pluginId:"infocolumn",init:function(t){this.grid=t}}),Ext.define("Plugins.grid.GridSearchPlugin",{extend:"Ext.AbstractPlugin",alias:"widget.plugin.searchgrid",statics:{doLocalSearch:function(t,e){var n=e.getStore(),i=t.getStore();i.clearFilter(),0!=n.getCount()&&i.filterBy(function(t){var e=!1;return n.each(function(n){var i=!0,d=n.getData();for(var o in d)if(d[o]&&"id"!=o&&(t.get(o)===!1||0==t.get(o)||t.get(o))){var l=d[o].filterValue,a=d[o].filterOp,s=t.get(o);switch(a){case"eq":l.toUpperCase()!=s.toUpperCase()&&(i=!1);break;case"eqBool":var r="all"==l;r||"yes"!=l||s!==!1||(i=!1),r||"no"!=l||s!==!0||(i=!1);break;case"diff":l.toUpperCase()==s.toUpperCase()&&(i=!1);break;case"start":Ext.String.startsWith(s,l,!0)||(i=!1);break;case"contains":s.toUpperCase().indexOf(l.toUpperCase())<0&&(i=!1);break;case"end":Ext.String.endsWith(s,l,!0)||(i=!1);break;case"eqDate":l()!==s&&(i=!1);break;case"eqNbr":l()!=s&&(i=!1);break;case"gtNbr":l()<=s&&(i=!1);break;case"lteNbr":l()>s&&(i=!1);break;case"gteNbr":l()<s&&(i=!1);break;case"ltNbr":l()>=s&&(i=!1);break;case"diffNbr":l()==s&&(i=!1)}}i&&(e=!0)}),e})},configure:function(t,e){e.searchObj={};var n=[],i=[];t.columns.forEach(function(t){t.dataIndex&&i.push({name:t.dataIndex})});var d,o=new Ext.data.Store({fields:i});d={xtype:"rownumberer"},n.push(d),t.columns.forEach(function(t){if(t.createFilter){switch(d={},d.dataIndex=t.dataIndex,d.initFilterValue=t.initFilterValue||null,d.width=t.filterWidth||t.width,t.filterFlex&&(d.flex=t.filterFlex),d.xtype="widgetcolumn",t.bind?d.text=translate(t.config.bind.text.substring(7,t.config.bind.text.length-1)):d.text=t.text,d.widget={},d.widget.xtype="textfilter",t.filterType){case"combobox":d.widget.xtype="combofilter",t.filterValues&&(d.widget.filterValues=t.filterValues);break;case"boolean":d.widget.xtype="booleanfilter";break;case"numeric":d.widget.xtype="numericfilter";break;case"date":d.widget.xtype="datefilter";break;case"time":d.widget.xtype="timefilter"}d.onWidgetAttach=function(e,n,i){var d=n,o={};e.initFilterValue&&(o=t.initFilterValue,d.setValue(o))},d.widget.dataIndex=d.dataIndex,n.push(d)}}),e.reconfigure(o,n)}},config:{toolbarSelector:null},pluginId:"gridsearch",init:function(t){this.grid=t;var e=t.query("#searchToolbar");1==e.length?(this.tb=e[0],this.fillToolbar()):0==e.length&&(this.tb=this.createNewToolbar(),this.fillToolbar(),t.addDocked(this.tb))},createNewToolbar:function(){var t=Ext.create("Ext.toolbar.Toolbar",{dock:"top",itemId:"searchToolbar"});return t},fillToolbar:function(){this.createAddBtnCtn(),this.createDeleteBtnCtn(),this.createResetBtnCtn(),this.createApplyBtnCtn(),this.tb.add({xtype:"tbfill"}),this.tb.add(this.addSearchBtnCtn),this.tb.add(this.resetBtnCtn),this.tb.add(this.deleteSearchBtnCtn),this.tb.add(this.applyBtnCtn)},createResetBtnCtn:function(){var t=this;this.resetBtnCtn=Ext.create("Ext.container.Container",{itemId:"resetBtnCtn",items:[{xtype:"button",text:"",tooltip:"Delete All Search Criteria",itemId:"resetSearchBtn",glyph:"xf014@FontAwesome",listeners:{click:function(){t.grid.getStore().removeAll()}}}]})},createApplyBtnCtn:function(){var t=this;this.applyBtnCtn=Ext.create("Ext.container.Container",{itemId:"applySearchBtnCtn",items:[{xtype:"button",text:"Apply Search",tooltip:"Apply Search",itemId:"applySearchBtn",glyph:"xf002@FontAwesome",listeners:{click:function(e,n,i){var d=t.grid.searchObj;t.grid.fireEvent("applySearch",d)}}}]})},createAddBtnCtn:function(){var t=this;this.addSearchBtnCtn=Ext.create("Ext.container.Container",{itemId:"addSearchBtnCtn",items:[{xtype:"button",itemId:"addSearchBtn",glyph:"xf00e@FontAwesome",text:"",tooltip:"Add Search Criteria",listeners:{click:function(){var e=t.grid.getStore();e.insert(e.getCount(),{})}}}]})},createDeleteBtnCtn:function(){var t=this;this.deleteSearchBtnCtn=Ext.create("Ext.container.Container",{itemId:"deleteSearchBtnCtn",items:[{xtype:"button",itemId:"deleteSearchBtn",glyph:"xf010@FontAwesome",text:"",tooltip:"Delete selected Criteria",listeners:{click:function(e,n,i){t.grid.getStore().remove(t.grid.getSelectionModel().getSelection())}}}]})}});